<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Host Stream</title>
  <style>body { font-family: sans-serif; text-align: center; }</style>
</head>
<body>
  <h1>üé• Host Stream</h1>
  <p>URL ƒë·ªÉ k·∫øt n·ªëi:</p>
  <input id="offerUrl" type="text" readonly style="width: 80%; padding: 10px; font-size: 16px;" />
  <button onclick="copyToClipboard()">Sao ch√©p URL</button>
  <p>Qu√©t m√£ QR ho·∫∑c sao ch√©p URL ƒë·ªÉ k·∫øt n·ªëi v·ªõi stream c·ªßa b·∫°n.</p>

  <script>
    const pc = new RTCPeerConnection();
    let localStream;

    // L·∫•y stream m√†n h√¨nh
    navigator.mediaDevices.getDisplayMedia({ video: true }).then(stream => {
      localStream = stream;
      stream.getTracks().forEach(track => pc.addTrack(track, stream));
      return pc.createOffer();
    }).then(offer => {
      return pc.setLocalDescription(offer).then(() => offer);
    }).then(offer => {
      // T·∫°o ID duy nh·∫•t cho offer
      const offerId = 'offer_' + Date.now();
      
      // L∆∞u offer v√†o localStorage
      localStorage.setItem(offerId, JSON.stringify(pc.localDescription));

      // T·∫°o URL ch·ª©a offerId
      const offerUrl = `${window.location.origin}/client.html?offerId=${JSON.stringify(pc.localDescription)}`;
      
      // ƒê·∫∑t offerUrl v√†o √¥ nh·∫≠p vƒÉn b·∫£n
      document.getElementById('offerUrl').value = offerUrl;
      
      console.log("Offer URL ƒë∆∞·ª£c t·∫°o. Qu√©t ƒë·ªÉ k·∫øt n·ªëi!");
    });

    // H√†m sao ch√©p URL v√†o clipboard
    function copyToClipboard() {
      const copyText = document.getElementById('offerUrl');
      copyText.select();
      copyText.setSelectionRange(0, 99999); // Cho c√°c thi·∫øt b·ªã di ƒë·ªông

      // Sao ch√©p URL v√†o clipboard
      document.execCommand('copy');
      alert("ƒê√£ sao ch√©p URL!");
    }
  </script>
</body>
</html>
