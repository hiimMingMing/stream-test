<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Host Stream</title>
  <style>body { font-family: sans-serif; text-align: center; }</style>
</head>
<body>
  <h1>üé• Host Stream</h1>
  <canvas id="qrcode"></canvas>
  <p>ƒêang t·∫°o QR...</p>

  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>

  <script>
    const pc = new RTCPeerConnection();
    let localStream;

    // L·∫•y stream m√†n h√¨nh
    navigator.mediaDevices.getDisplayMedia({ video: true }).then(stream => {
      localStream = stream;
      stream.getTracks().forEach(track => pc.addTrack(track, stream));
      return pc.createOffer();
    }).then(offer => {
      return pc.setLocalDescription(offer).then(() => offer);
    }).then(offer => {
      // T·∫°o ID duy nh·∫•t cho offer
      const offerId = 'offer_' + Date.now();
      
      // L∆∞u offer v√†o localStorage
      localStorage.setItem(offerId, JSON.stringify(pc.localDescription));

      // T·∫°o URL ch·ª©a offerId
      const offerUrl = `${window.location.href}client.html?offerId=${pc.localDescription}`;
      
      // T·∫°o QR Code t·ª´ URL
      QRCode.toCanvas(document.getElementById('qrcode'), offerUrl);
      
      console.log("QR Code ƒë∆∞·ª£c t·∫°o. Qu√©t ƒë·ªÉ k·∫øt n·ªëi!");
    });
  </script>
</body>
</html>
